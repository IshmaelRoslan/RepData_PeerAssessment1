---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---
## Install Libraries
```{r, message=FALSE}
library(dplyr)
library(ggplot2)
```
## Loading and preprocessing the data
Download and read files
```{r read}
activity <- read.csv(unz("activity.zip", "activity.csv"), colClasses = c("double","character","double"))
activity$date <- as.Date(activity$date, "%Y-%m-%d")
activity <- tbl_df(activity)
```

## What is mean total number of steps taken per day?
Summarize the activity table by total steps per day.
```{r daily}
day <- group_by(activity,date)
daytotals <- summarize(day,steps = sum(steps, na.rm = TRUE))
```
Calculate mean and median for use in the summary statement.
```{r dailystats}
mean <- mean(daytotals$steps)
median <- median(daytotals$steps)
```
Plot histogram with a vertical line showing the median and mean.
```{r histogram, fig.height=6,fig.width=10}
ggplot(daytotals, aes(x = steps)) +
        geom_histogram(bins = 30) +
        geom_vline(xintercept = mean, color = "red") +
        geom_text(aes(
                x = mean - 2000,
                y = 10,
                label = paste("mean =", round(mean, 0))
                
        ), color = "red") +
        geom_text(aes(
                x = median + 2000,
                y = 10,
                label = paste("median =", round(median, 0))
                
        ), color = "blue") +
        geom_vline(xintercept = median, color = "blue") +
        xlab("Total Daily Steps") +
        ylab("Number of Days") +
        ggtitle("Distribution of Total Daily Steps") +
        theme(plot.title = element_text(hjust = 0.5))
```

The mean and median number of steps per day are **`r round(mean,0)`** and **`r median`** respectively.

## What is the average daily activity pattern?
Summarize the Interval data by mean.
```{r timedata}
time <- group_by(activity,interval)
times <- summarize(time,steps=mean(steps,na.rm=TRUE))
##Variables to be used in the text below. 
maxsteps <- round(max(times$steps),0)
maxinterval <- round(as.numeric(times[which.max(times$steps),1]),0)
```
The most active interval is **`r maxinterval`** with an average of **`r maxsteps`** steps.

Now to plot the time series.
```{r timeseries,fig.height=6,fig.width=10}
g1 <- ggplot(times, aes(x=interval, y=steps)) +
        geom_line() +
        xlab("Interval") +
        ylab("Steps") +
        ggtitle("A Time Series of the Average Number of Steps")
g1
```


## Imputing missing values
There are `r sum(is.na(activity$steps))` missing values.

Define a new instance of the **activty** table called **imputed**.
Replace missing values in **imputed** with mean from the **times** table.
```{r impute}
imputed <- read.csv(unz("activity.zip", "activity.csv"),
                    colClasses = c("double", "character", "double"))
for (i in 1:nrow(imputed)) {
        if (is.na(imputed[i, 1]) == TRUE)
        {
                imputed[i, 1] <- times[match(imputed[i, 3], times$interval), 2]
        }
}
```
Check that there are now no missing values.
```{r}
summary(imputed)
```
## Are there differences in activity patterns between weekdays and weekends?
